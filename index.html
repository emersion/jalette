<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>Jalette</title>

	<link rel="stylesheet" href="//cdn.jsdelivr.net/bootstrap/3.2.0/css/bootstrap.min.css">
</head>
<body>
	<div class="container">
		<h1>Jalette<small> - palette generation made easy</small></h1>

		<div id="palette-steps" class="panel panel-primary">
			<div class="panel-body">
				<h2>Generating a palette</h2>

				<div id="colors-row"></div>

				<form class="form-horizontal">
					<div class="form-group">
						<label for="palette-n" class="col-sm-3 control-label">Generate a new palette</label>
						<div class="col-sm-2">
							<input type="number" id="palette-n" class="form-control" placeholder="Number of colors">
						</div>
						<button type="button" id="palette-submit" class="btn btn-default">Generate</button>
					</div>
					<div class="form-group">
						<label class="col-sm-3 control-label">Generate a new color for this palette</label>
						<div class="col-sm-2">
							<button type="button" id="color-submit" class="btn btn-primary">Generate</button>
						</div>
					</div>
					<div class="form-group">
						<label class="col-sm-3 control-label">Add a custom color</label>
						<div class="col-sm-1">
							<input type="color" id="custom-color" class="form-control" placeholder="#000000">
						</div>
						<button type="button" id="custom-submit" class="btn btn-default">Add</button>
					</div>
				</form>
			</div>
		</div>

		<div id="palette-steps" class="panel panel-default">
			<div class="panel-body">
				<h2>Palette steps</h2>
				<small>Coming soon...</small>
			</div>
		</div>

		<div id="lab-space" class="panel panel-default">
			<div class="panel-body">
				<h2>CIELAB color space <small>L=<span class="lab-space-l-val"></span></small></h2>
				<input id="lab-space-l" type="range" min="0" max="100" step="1" value="0">
				<canvas id="lab-space-canvas" width="600" height="600"></canvas>
			</div>
		</div>
	</div>

	<script src="//cdn.jsdelivr.net/jquery/2.1.1/jquery.min.js"></script>
	<script src="//cdn.jsdelivr.net/bootstrap/3.2.0/js/bootstrap.min.js"></script>
	<script src="src/jalette.js"></script>
	<script>
		var $colors = $('#colors-row');
		var palette = [];

		function appendColor(color) {
			var paletteLength = palette.push(color);

			$colors.append(
				$('<div></div>').css({
					display: 'inline-block',
					width: 50,
					height: 50,
					backgroundColor: color.toRgb().toRoundedString(),
					cursor: 'pointer'
				}).attr('title', 'Click to remove').click(function () {
					palette.splice(paletteLength - 1, 1);
					$(this).remove();
					console.log(paletteLength, palette);
				})
			);
		}
		function generate(n) {
			$colors.empty();
			palette = [];

			var colors = jalette.generate(n);

			for (var i = 0; i < colors.length; i++) {
				appendColor(colors[i]);
			}

			return colors;
		}
		function generateColor() {
			var color = jalette.generateColor(palette);

			appendColor(color);
		}

		$('#palette-submit').click(function () {
			var n = parseInt($('#palette-n').val());
			generate(n);
		});
		$('#color-submit').click(function () {
			generateColor();
		});
		$('#custom-submit').click(function () {
			var color = $('#custom-color').val();
			appendColor(jalette.Rgb.fromHex(color));
		});

		function drawGrid(canvas) {
			var ctx = canvas.getContext('2d');

			ctx.fillStyle = 'rgb(200,200,200)';
			ctx.fillRect(canvas.width/2, 0, 1, canvas.height);
			ctx.fillRect(0, canvas.height/2, canvas.width, 1);
		}

		var $labSpaceCanvas = $('#lab-space-canvas'),
			labSpaceCtx = $labSpaceCanvas[0].getContext('2d');
		$('#lab-space-l').on('input', function () {
			var canvas = $labSpaceCanvas[0], ctx = labSpaceCtx;
			var L = parseInt($(this).val());

			ctx.clearRect(0, 0, canvas.width, canvas.height);
			drawGrid(canvas);
			jalette.Lab.drawSpaceForL(canvas, L);
			$('#lab-space .lab-space-l-val').text(L);
		}).trigger('input');
	</script>
</body>
</html>